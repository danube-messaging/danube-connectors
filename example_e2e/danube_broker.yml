# Danube Broker Configuration for SurrealDB Sink Example
# Simplified setup without S3/MinIO for easy testing

# Danube cluster name
cluster_name: "SURREALDB_SINK_EXAMPLE"

# Danube Broker hostname
broker_host: "0.0.0.0"

# Ports for the Danube broker services
broker_port: 6650
admin_port: 50051
prom_port: 9040

# Metadata Persistent Store address (ETCD)
meta_store_host: "etcd"
meta_store_port: 2379

# Namespaces to be created on boot
bootstrap_namespaces:
  - "default"

# Allow producers to auto-create topics when missing
auto_create_topics: true

# Security Configuration - Disabled for development
auth:
  mode: none

# WAL and Storage Configuration - Memory backend for simple example
wal_cloud:
  wal:
    dir: "/data/wal"
    file_name: "wal.log"
    cache_capacity: 512
    file_sync:
      interval_ms: 5000
      max_batch_bytes: 10485760
    rotation:
      max_bytes: 268435456  # 256 MiB for example
    retention:
      time_minutes: 60       # 1 hour retention for example
      size_mb: 1024          # 1 GiB per topic
      check_interval_minutes: 5

  # Uploader configuration (required fields even if using memory backend)
  uploader:
    enabled: true
    interval_seconds: 60
    root_prefix: "/danube-data"
    max_object_mb: 1024

  # Cloud storage backend - Memory for development/testing
  cloud:
    backend: "memory"
    root: "surrealdb-example"

  # Metadata configuration
  metadata:
    etcd_endpoint: "etcd:2379"
    in_memory: false

# Broker policies - relaxed for testing
policies:
  max_producers_per_topic: 0
  max_subscriptions_per_topic: 0
  max_consumers_per_topic: 0
  max_consumers_per_subscription: 0
  max_publish_rate: 0
  max_subscription_dispatch_rate: 0
  max_message_size: 10485760  # 10 MB
