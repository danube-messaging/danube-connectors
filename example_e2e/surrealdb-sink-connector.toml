# =============================================================================
# SurrealDB Sink Connector Configuration - End-to-End Example
# =============================================================================

# Core Danube settings
danube_service_url = "http://danube-broker:6650"
connector_name = "surrealdb-sink-e2e"

# Retry settings
[retry]
max_retries = 3
retry_backoff_ms = 1000
max_backoff_ms = 30000

# Processing settings
[processing]
batch_size = 100
batch_timeout_ms = 1000
poll_interval_ms = 100
metrics_port = 9090
log_level = "info"

# =============================================================================
# SurrealDB Configuration
# =============================================================================

[surrealdb]
# SurrealDB connection URL (host:port format for WebSocket)
url = "surrealdb:8000"

# SurrealDB namespace and database
namespace = "default"
database = "default"

# Authentication (set via environment variables)
# username = from SURREALDB_USERNAME
# password = from SURREALDB_PASSWORD

# Connection timeouts
connection_timeout_secs = 30
request_timeout_secs = 30

# Global batch settings
batch_size = 100
flush_interval_ms = 3000

# =============================================================================
# Topic Mapping: Stripe Payments â†’ SurrealDB
# =============================================================================

[[surrealdb.topic_mappings]]
# Consume from Stripe payments topic
topic = "/stripe/payments"
subscription = "surrealdb-payment-sink"
subscription_type = "Shared"

# Write to SurrealDB table
table_name = "stripe_payments"

# Schema validation
expected_schema_subject = "stripe-payment-v1"

# Storage configuration
storage_mode = "Document"
include_danube_metadata = true

# Batch settings for this topic
batch_size = 50
flush_interval_ms = 2000
